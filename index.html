<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KayÄ±p Yavru KÃ¶pek: Åeker DiyarÄ±</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #ffe6f2;
            /* Default pink */
            font-family: 'Times New Roman', Times, serif;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            pointer-events: none;
        }
    </style>
    <style>
        #error-box {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 0, 0, 0.9);
            color: white;
            font-family: monospace;
            padding: 10px;
            z-index: 99999;
            display: none;
            white-space: pre-wrap;
        }

        #loading-msg {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: #ff3366;
            z-index: 50;
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ff3366;
        }
    </style>
    <!-- Detailed Error Handling -->
    <script>
        window.addEventListener('error', function (event) {
            const box = document.getElementById('error-box');
            box.style.display = 'block';
            let msg = event.message || "Bilinmeyen Hata";
            if (event.target && (event.target.tagName === 'SCRIPT' || event.target.tagName === 'IMG' || event.target.tagName === 'LINK')) {
                msg = "YÃ¼kleme HatasÄ± (Dosya bulunamadÄ± veya aÄŸ sorunu): " + (event.target.src || event.target.href);
            }
            box.innerHTML += `ğŸ›‘ HATA: ${msg}<br>`;
            console.error(msg);
        }, true); // Capture phase enabled
    </script>

    <!-- Three.js CDN -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>

<body>
    <div id="error-box"></div>
    <div id="loading-msg">
        <div style="font-size: 3rem;">ğŸ¶</div>
        <div>ÅEKER DÄ°YARI</div>
        <small style="font-size: 1rem; opacity: 0.7;">YÃ¼kleniyor...</small>
    </div>

    <div id="game-container">

        <!-- Main Menu -->
        <div id="main-menu" class="ui-screen">
            <!-- New Features -->
            <button id="theme-toggle" title="Tema DeÄŸiÅŸtir">ğŸŒ“</button>
            <div id="high-score-display" class="high-score-badge">ğŸ† EN Ä°YÄ°: <span id="high-score-val">0</span></div>

            <div class="glass-panel">
                <h1>KayÄ±p Yavru KÃ¶pek</h1>
                <p style="margin-bottom: 20px;">ğŸ¬ Åeker DiyarÄ± MacerasÄ± ğŸ¬</p>

                <div
                    style="display:flex; flex-direction:column; gap:15px; width: 100%; max-width: 300px; margin: 0 auto;">
                    <button id="start-btn" class="btn-primary">OYUNA BAÅLA â–¶</button>
                    <button id="shop-btn" class="btn-accent">MAÄAZA ğŸª</button>
                    <button id="levels-btn" class="btn-secondary">SEVÄ°YELER ğŸ—ºï¸</button>
                </div>
            </div>
        </div>

        <!-- Level Select Menu -->
        <div id="level-menu" class="ui-screen hidden">
            <div class="glass-panel" style="width: 90%; max-width: 800px;">
                <h2>ğŸ—ºï¸ BÃ–LÃœM SEÃ‡</h2>

                <div
                    style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 15px;">
                    <button id="prev-world-btn" class="btn-secondary"
                        style="padding: 5px 15px; border-radius: 10px;">â—€</button>
                    <h3 id="world-title" style="margin: 0; color: var(--text-main); font-family: 'Fredoka One';">DÃ¼nya 1
                    </h3>
                    <button id="next-world-btn" class="btn-secondary"
                        style="padding: 5px 15px; border-radius: 10px;">â–¶</button>
                </div>

                <div class="scroll-container">
                    <div id="level-grid" class="interactive">
                        <!-- Levels will be populated by JS -->
                    </div>
                </div>

                <button id="level-back-btn" class="btn-danger" style="margin-top: 20px;">GERÄ° DÃ–N â†©ï¸</button>
            </div>
        </div>

        <!-- Shop Menu -->
        <div id="shop-menu" class="ui-screen hidden">
            <div class="glass-panel" style="width: 90%; max-width: 600px;">
                <h2>MAÄAZA ğŸª</h2>

                <div class="shop-currency-header">
                    Mevcut Åeker: <span id="shop-coins-val" style="color: var(--primary-color);">0</span> ğŸ¬
                </div>

                <div class="shop-tabs">
                    <button class="shop-tab-btn active-tab" data-tab="colors">Renkler</button>
                    <button class="shop-tab-btn" data-tab="accessories">Aksesuar</button>
                    <button class="shop-tab-btn" data-tab="trails">Ä°zler</button>
                </div>

                <div class="scroll-container">
                    <div id="shop-items" class="interactive">
                        <!-- Items will be populated by JS -->
                    </div>
                </div>

                <button id="back-btn" class="btn-danger" style="margin-top: 20px;">KAPAT âŒ</button>
            </div>
        </div>

        <!-- HUD (Heads Up Display) -->
        <div id="hud" class="hidden">
            <div class="hud-group">
                <div class="hud-item" id="score-container">â­ <span id="score">0</span></div>
                <div class="hud-item" id="distance-container">ğŸ“ <span id="distance">0</span>m</div>
            </div>

            <div class="hud-group">
                <div class="hud-item" style="color: #ff6b81;">ğŸ­ <span id="candy-pink">0</span></div>
                <div class="hud-item" style="color: #54a0ff;">ğŸ¬ <span id="candy-blue">0</span></div>
                <button id="pause-btn">â¸ï¸</button>
            </div>
        </div>

        <!-- Pause Menu -->
        <div id="pause-menu" class="ui-screen hidden" style="background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);">
            <div class="glass-panel">
                <h2>DURAKLATILDI â¸ï¸</h2>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <button id="resume-btn" class="btn-primary">DEVAM ET â–¶</button>
                    <button id="quit-btn" class="btn-danger">ANA MENÃœ ğŸ </button>
                </div>
            </div>
        </div>

        <!-- Level Complete Screen -->
        <div id="level-complete" class="ui-screen hidden">
            <div class="glass-panel">
                <h2>ğŸ‰ SEVÄ°YE TAMAMLANDI!</h2>
                <div style="font-size: 4rem; margin: 20px;">â­â­â­</div>
                <p>KazanÄ±lan Bonus: <span id="level-reward" style="color: var(--success-color);">0</span></p>

                <button id="next-level-btn" class="btn-primary">SONRAKÄ° SEVÄ°YE â–¶</button>
                <button id="main-menu-btn-2" class="btn-secondary" onclick="location.reload()"> ANA MENÃœ ğŸ </button>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over" class="ui-screen hidden">
            <div class="glass-panel">
                <h2 style="color: var(--danger-color);">OYUN BÄ°TTÄ° ğŸ˜¢</h2>
                <p>Toplam Skor: <span id="final-score" style="font-size: 1.5rem;">0</span></p>

                <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
                    <button id="ad-revive-btn" class="btn-ad">ğŸ“º REKLAM Ä°ZLE (+1 CAN)</button>
                    <button id="restart-btn" class="btn-primary">TEKRAR DENE ğŸ”„</button>
                    <button id="main-menu-btn" class="btn-secondary">ANA MENÃœ ğŸ </button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="game.js"></script>
</body>

</html>