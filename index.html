<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KayÄ±p Yavru KÃ¶pek: Åeker DiyarÄ±</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #ffe6f2;
            /* Default pink */
            font-family: 'Comic Sans MS', cursive, sans-serif;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            pointer-events: none;
        }
    </style>
    <style>
        #error-box {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 0, 0, 0.9);
            color: white;
            font-family: monospace;
            padding: 10px;
            z-index: 99999;
            display: none;
            white-space: pre-wrap;
        }

        #loading-msg {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: #ff3366;
            z-index: 50;
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ff3366;
        }
    </style>
    <!-- Detailed Error Handling -->
    <script>
        window.addEventListener('error', function (event) {
            const box = document.getElementById('error-box');
            box.style.display = 'block';
            let msg = event.message || "Bilinmeyen Hata";
            if (event.target && (event.target.tagName === 'SCRIPT' || event.target.tagName === 'IMG' || event.target.tagName === 'LINK')) {
                msg = "YÃ¼kleme HatasÄ± (Dosya bulunamadÄ± veya aÄŸ sorunu): " + (event.target.src || event.target.href);
            }
            box.innerHTML += `ğŸ›‘ HATA: ${msg}<br>`;
            console.error(msg);
        }, true); // Capture phase enabled
    </script>

    <!-- Three.js CDN -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>

<body>
    <div id="error-box"></div>
    <div id="loading-msg">Oyun YÃ¼kleniyor...<br><small style="font-size:1rem; color: #666;">Bekleyiniz...</small></div>
    <div id="game-container">
        <!-- Main Menu -->
        <div id="main-menu" class="ui-screen">
            <h1>ğŸ¶ KayÄ±p Yavru KÃ¶pek ğŸ¬ <small style="font-size: 0.4em; color: #555;">v2.0</small></h1>
            <p>Åeker DiyarÄ± MacerasÄ±</p>
            <div style="display:flex; flex-direction:column; gap:10px; width:200px; margin:0 auto;">
                <button id="start-btn" class="btn-primary" style="width:100%;">OYUNA BAÅLA â–¶</button>
                <button id="shop-btn" class="btn-secondary" style="background-color: #be6216; width:100%;">MAÄAZA
                    ğŸª</button>
                <button id="levels-btn" class="btn-secondary" style="background-color: #4CAF50; width:100%;">SEVÄ°YELER
                    ğŸ—ºï¸</button>
            </div>
            <p class="instructions">YÃ¶n TuÅŸlarÄ± veya A/D ile Hareket Et<br>BoÅŸluk ile ZÄ±pla</p>
        </div>

        <!-- Level Select Menu -->
        <div id="level-menu" class="ui-screen hidden" style="background: rgba(230,255,250,0.95); z-index: 10;">
            <h2>ğŸ—ºï¸ BÃ¶lÃ¼m SeÃ§ ğŸ“</h2>

            <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 10px;">
                <button id="prev-world-btn" class="btn-secondary" style="padding: 5px 15px;">â—€</button>
                <h3 id="world-title" style="margin: 0; color: #444;">DÃ¼nya 1</h3>
                <button id="next-world-btn" class="btn-secondary" style="padding: 5px 15px;">â–¶</button>
            </div>

            <div id="level-grid"
                style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; max-width: 600px; margin: 20px auto; overflow-y: auto; max-height: 50vh;">
                <!-- Levels will be populated by JS -->
            </div>
            <button id="level-back-btn" class="btn-secondary">GERÄ° DÃ–N â†©ï¸</button>
        </div>

        <!-- Shop Menu -->
        <div id="shop-menu" class="ui-screen hidden" style="background: rgba(255,230,242,0.95); z-index: 10;">
            <h2>ğŸ¶ KÃ¶pek MaÄŸazasÄ± ğŸª</h2>
            <div id="shop-coins">Mevcut Åeker: <span id="shop-coins-val">0</span> ğŸ¬</div>
            <div id="shop-items"
                style="display: flex; flex-direction: column; gap: 20px; margin: 20px; overflow-y: auto; max-height: 70vh;">
                <!-- Items will be populated by JS -->
            </div>
            <button id="back-btn" class="btn-secondary">GERÄ° DÃ–N â†©ï¸</button>
        </div>

        <!-- HUD (Heads Up Display) -->
        <div id="hud" class="hidden">
            <div id="score-container"><span id="score">0</span></div>
            <div id="distance-container">Mesafe: <span id="distance">0</span>m / <span id="level-target">250</span>m
            </div>

            <div class="candy-counters">
                <div class="candy-counter" style="color: #ff3366;">ğŸ­ <span id="candy-pink">0</span></div>
                <div class="candy-counter" style="color: #3399ff;">ğŸ¬ <span id="candy-blue">0</span></div>
            </div>

            <!-- Total Currency Removed -->

            <button id="pause-btn" style="background: none; border: none; font-size: 2rem; cursor: pointer;">â¸ï¸</button>
        </div>

        <!-- Pause Menu -->
        <div id="pause-menu" class="ui-screen hidden" style="background: rgba(0,0,0,0.5); z-index: 20;">
            <h2>Oyun DuraklatÄ±ldÄ± â¸ï¸</h2>
            <button id="resume-btn" class="btn-primary">DEVAM ET â–¶</button>
            <button id="quit-btn" class="btn-secondary">ANA MENÃœ ğŸ </button>
        </div>

        <!-- Level Complete Screen -->
        <div id="level-complete" class="ui-screen hidden" style="background: rgba(255,255,255,0.9); z-index: 20;">
            <h2>ğŸ‰ Seviye TamamlandÄ±! ğŸ¬</h2>
            <p>Bonus: <span id="level-reward">0</span> Åeker</p>
            <button id="next-level-btn" class="btn-primary">SONRAKÄ° SEVÄ°YE â–¶</button>
            <button id="main-menu-btn-2" class="btn-secondary" onclick="location.reload()"> ANA MENÃœ ğŸ </button>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over" class="ui-screen hidden">
            <h2>Oyun Bitti! ğŸ˜¢</h2>
            <p>Skorun: <span id="final-score">0</span></p>
            <button id="restart-btn" class="btn-secondary">Tekrar Dene ğŸ”„</button>
            <button id="main-menu-btn" class="btn-secondary" style="background-color: #ff99cc;">Ana MenÃ¼ ğŸ </button>
            <button id="ad-revive-btn" class="btn-ad">ğŸ“º Reklam Ä°zle ve Devam Et (+1 Can)</button>
        </div>
    </div>

    <script type="module" src="game.js?v=2.1"></script>
</body>

</html>